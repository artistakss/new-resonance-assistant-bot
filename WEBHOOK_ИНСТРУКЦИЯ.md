# üì° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Webhook (–±–µ—Å–ø–ª–∞—Ç–Ω–æ —á–µ—Ä–µ–∑ ngrok)

## –ß—Ç–æ —Ç–∞–∫–æ–µ Webhook?

**Polling (—Ç–µ–∫—É—â–∏–π —Å–ø–æ—Å–æ–±):**
- –ë–æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É Telegram: "–ï—Å—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è?"
- –ü—Ä–æ–±–ª–µ–º–∞: –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∏—Å—Ö–æ–¥—è—â–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**Webhook (–Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–±):**
- Telegram —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π URL
- –ü–ª—é—Å: —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∏—Å—Ö–æ–¥—è—â–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ngrok –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /tmp
wget https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-linux-amd64.tgz
tar -xzf ngrok-v3-stable-linux-amd64.tgz
sudo mv ngrok /usr/local/bin/
ngrok version  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```

## –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ ngrok —Ç—É–Ω–Ω–µ–ª—è

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∏–ª–∏ —á–µ—Ä–µ–∑ screen/tmux)
ngrok http 8000
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL –≤–∏–¥–∞: `https://abc123.ngrok.io`

**–í–∞–∂–Ω–æ:** URL –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ ngrok (–≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏).

## –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ FastAPI –¥–ª—è webhook —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /root/resonance-assistant
source .venv/bin/activate
pip install fastapi uvicorn
```

## –®–∞–≥ 4: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –±–æ—Ç–∞ –¥–ª—è webhook

–ù—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª `bot_webhook.py` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π webhook.

## –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook –≤ Telegram

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook URL
curl -X POST "https://api.telegram.org/bot<TOKEN>/setWebhook" \
  -d "url=https://abc123.ngrok.io/webhook"
```

## –ü—Ä–æ–±–ª–µ–º—ã —Å ngrok:

1. **URL –º–µ–Ω—è–µ—Ç—Å—è** - –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å webhook –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
2. **–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞** - –Ω–æ –¥–ª—è –±–æ—Ç–∞ –¥–æ–ª–∂–Ω–æ —Ö–≤–∞—Ç–∏—Ç—å

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Cloudflare Tunnel (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ)

Cloudflare Tunnel –¥–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π URL, –Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–æ–∂–Ω–µ–µ.

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–æ–∂–¥–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PS.kz. –ï—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–æ–º–æ–≥—É—Ç, –ø–æ–ø—Ä–æ–±—É–µ–º webhook.

